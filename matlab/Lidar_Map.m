clear;
% 生成一些示例数据
%angles = [0.00, 1.55, 2.00, 2.93, 4.07, 5.41, 5.64, 7.49, 8.08, 9.47, 9.22, 10.18, 11.87, 12.73, 13.55, 14.64, 15.24, 16.83, 17.87, 18.39, 18.91, 20.12, 20.91, 21.74, 22.86, 23.91, 24.65, 25.79, 26.46, 26.82, 27.55, 29.51, 30.24, 30.96, 32.24, 32.70, 34.02, 33.96, 35.69, 36.79, 38.11, 38.01, 38.54, 40.89, 41.87, 41.20, 43.85, 44.27, 44.84, 45.90, 46.90, 47.56, 48.93, 49.01, 50.58, 51.31, 52.05, 52.54, 53.97, 53.82, 55.01, 56.46, 57.48, 58.75, 59.84, 60.53, 61.50, 62.23, 62.50, 63.97, 64.55, 65.57, 67.56, 67.86, 68.85, 68.97, 70.47, 71.77, 72.32, 73.41, 74.05, 75.87, 75.99, 77.06, 78.02, 78.32, 79.80, 81.14, 80.85, 82.64, 82.78, 84.85, 84.32, 85.88, 87.01, 88.19, 89.30, 89.52, 90.28, 91.16, 91.24, 92.84, 94.97, 94.95, 96.11, 97.02, 97.99, 100.05, 99.42, 100.52, 101.78, 102.52, 103.61, 103.88, 105.91, 106.86, 106.82, 108.82, 108.70, 110.25, 110.95, 111.77, 112.69, 114.02, 114.47, 115.68, 115.78, 117.89, 118.65, 119.18, 121.13, 121.37, 121.82, 122.87, 123.55, 124.07, 125.84, 126.25, 126.59, 128.22, 129.74, 130.69, 130.99, 132.54, 132.67, 134.23, 133.98, 135.65, 136.09, 137.41, 137.80, 140.29, 140.26, 141.07, 142.41, 143.78, 143.85, 144.64, 144.85, 146.90, 147.47, 148.95, 149.30, 149.60, 151.12, 151.72, 154.22, 154.56, 154.89, 155.34, 157.54, 157.83, 159.15, 159.37, 160.90, 159.14, 161.31, 163.30, 165.48, 165.69, 165.70, 167.08, 168.42, 168.41, 168.62, 171.26, 171.30, 172.31, 172.74, 174.48, 175.16, 175.58, 176.41, 177.98, 178.13, 179.22, 180.50, 182.30, 182.26, 183.09, 184.40, 186.12, 184.93, 184.71, 188.70, 189.53, 189.62, 190.84, 191.36, 192.55, 193.33, 194.96, 196.27, 196.40, 197.21, 198.63, 199.10, 199.69, 200.62, 203.00, 202.88, 204.21, 205.27, 206.10, 206.92, 206.24, 208.75, 209.04, 210.41, 211.69, 211.74, 213.17, 213.71, 214.39, 217.36, 216.77, 217.42, 219.32, 220.78, 219.95, 220.63, 223.20, 223.13, 222.42, 224.93, 225.95, 227.20, 226.79, 228.78, 230.28, 229.68, 231.15, 232.21, 233.13, 233.89, 235.57, 236.32, 236.97, 237.85, 236.70, 236.46, 240.36, 242.42, 242.17, 243.81, 244.14, 245.19, 246.28, 246.83, 248.06, 247.81, 250.22, 251.55, 252.43, 252.16, 253.79, 255.48, 254.34, 255.80, 257.83, 257.48, 258.84, 259.59, 261.17, 261.32, 261.35, 263.57, 265.48, 264.49, 266.07, 268.16, 269.21, 268.77, 265.94, 263.83, 273.21, 274.79, 274.35, 275.23, 275.51, 276.38, 278.38, 278.68, 278.53, 280.02, 281.45, 282.81, 282.38, 284.39, 281.61, 283.23, 286.27, 288.53, 288.88, 289.65, 289.53, 291.71, 293.59, 292.44, 292.85, 295.53, 295.73, 296.62, 298.00, 298.98, 299.07, 300.12, 302.00, 302.92, 302.54, 299.39, 306.73, 307.51, 306.06, 306.62, 309.31, 309.06, 309.25, 312.17, 313.04, 312.96, 314.25, 315.56, 317.01, 316.19, 317.93, 318.97, 319.59, 320.82, 321.26, 321.42, 323.43, 323.24, 324.75, 327.49, 326.70, 328.13, 328.26, 331.12, 330.79, 330.46, 332.94, 334.12, 331.40, 333.25, 336.06, 337.09, 336.78, 338.35, 341.36, 340.76, 341.16, 342.35, 344.54, 343.49, 344.92, 346.41, 346.89, 347.40, 350.42, 351.00, 350.13, 350.76, 351.96, 354.57, 355.28, 354.74, 357.80, 357.79, 357.02, 358.38, 359.98, 359.88, 358.31, 359.27, 358.69, 359.65, 359.63, 359.93, 358.01];
%angles = [0.00, 3.53, 15.79, 15.42, 69.13, 70.52, 71.27, 72.46, 72.47, 74.40, 75.34, 75.51, 86.03, 118.14, 130.57, 131.34, 132.10, 132.48, 143.24, 144.25, 144.36, 145.67, 148.85, 154.47, 161.89, 163.17, 172.34, 172.94, 174.70, 176.45, 176.85, 177.12, 179.08, 217.97, 234.78, 241.06, 242.67, 243.59, 243.66, 244.06, 245.86, 247.27, 246.93, 248.52, 249.68, 250.32, 250.94, 253.01, 253.20, 254.01, 254.03, 255.49, 257.83, 258.15, 257.15, 260.51, 261.86, 261.59, 261.59, 263.59, 264.46, 265.19, 266.03, 267.90, 268.10, 268.23, 270.49, 271.71, 271.22, 271.50, 273.43, 274.93, 275.31, 276.37, 278.22, 277.84, 278.23, 279.77, 281.19, 281.47, 282.07, 284.44, 284.64, 285.40, 286.11, 287.58, 288.72, 288.86, 289.22, 291.61, 292.33, 292.53, 293.71, 295.00, 295.19, 295.69, 297.69, 298.40, 299.07, 299.00, 302.11, 301.45, 302.86, 302.50, 305.35, 305.18, 306.14, 306.85, 309.95, 309.74, 309.60, 333.84];
%distances = [ 402, 393, 385, 118, 366,  432,  482,  483,  482, 482,  482,  484,  484,  485,  487,  486,  0,   499,  491,  493,  494,  496,  498 , 501 , 502, 504 , 508,  509,  514,  515,  518,  524,  526,  527,  531,  533, 541, 545 , 551 , 554 , 559 , 562 , 568,  577, 578 , 591 , 594 , 603 , 611 , 614, 624,  630,  637, 646,  658,  668,  678,  696, 705,  715,  718,  732,  753,  766,  772,  793, 817,  827,  838,  876,  879,  905, 931, 960,  262,  261,  263,  0,   0,   0,   0,   0,   0,   1322,  1384,  1577,  1788,  2051,  1418,  1446,  1235,  1232,  0,   0,   1147,  1146,  1144,  1143,  1140,  1136,  1139,  1134,  1131,  1130,  1128,  1135,  770,  795,  1131,  1132,  1133,  1135,  1135,  1138,  1138,  1141,  1143,  1148,  987,  957,  956,  980,  983,  1190,  1191,  1209,  1196,  1211,  2131,  2152,  2153,  2159,  2175,  2157,  2172,  2228,  2265,  2267,  2281,  2287,  2334,  2372,  0,   0,   0,   3768,  3783,  3840,  3944,  3965,  3955,  2581,  2542,  2548,  2471,  0,  0,   233,  0,   0,   372,  390,  2525,  2483,  2453,  2082,  1090,  1085,  1084,  740,  741,  741,  737,  736,  787,  788,  156,  824,  836,  810,  785,  857,  298,  1225,  1095,  0,   0,   0,   0,   266,  266,  266,  1995,  295,  297,  0,   2937,  0,  3463,  3948,  4440,  6445,  2978,  2883,  371,  373,  373,  375,  398,  383,  399,  401,  402,  401,  405,  412,  410,  388,  394,  410,  409,  413,  418,  417,  422,  424,  425,  429,  432,  434,  440,  442,  444,  446,  453,  459,  462,  415,  441,  442,  446,  426,  402,  404,  398,  386,  371,  378,  366,  352,  359,  349,  332,  318,  322,  318,  322,  323,  316,  311,  302,  302,  296,  292,  291,  288,  284,  279,  279,  279,  272,  273,  269,  269,  266,  264,  263,  262,  263,  265,  257,  256,  255,  255,  253,  254,  251,  251,  251,  250,  249,  249,  249,  248,  247,  247,  247,  247,  247,  247,  247,  248,  248,  248,  249,  250,  250,  249,  251,  251,  250,  252,  254,  255,  255,  255,  257,  258,  259,  259,  262,  263,  263,  266,  268,  271,  269,  274,  277,  279,  281,  283,  286,  287,  289,  294,  298,  294,  303,  307,  308,  309,  318,  325,  322,  325,  340,  345,  345,  349,  362,  363,  366,  377,  391,  382,  395,  411,  417,  410,  426,  446,  461,  449,  426,  0,   461,  460,  453,  451,  448,  446,  440,  437,  434,  431,  423,  423,  426,  422,  416,  416,  416,  411,  410,  410,  410,  407,  404,  404,  404,  402,  402,  402,  403,  403,  405,  403,  403,  404];
%distances = [ 118,  263,  266,  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   170,  171,  246,  281,  0,   0,   0,   0,   0,   265,  0,   296,  297,  296,  0,   0,   300,  295,  287,  286,  287,  283,  278,  275,  275,  273,  269,  269,  267,  265,  263,  262,  262,  259,  259,  258,  256,  254,  254,  254,  252,  251,  251,  250,  249,  249,  249,  248,  247,  247,  247,  247,  247,  247,  247,  247,  248,  248,  248,  249,  250,  250,  250,  251,  252,  252,  252,  255,  255,  255,  255,  259,  260,  260,  262,  265,  265,  267,  271,  271,  272,  273,  277,  279,  279,  283,  287,  289,  289,  291,  296,  297,  299];

%angles = [348.34, 63.62, 65.13, 76.34, 233.23, 235.83, 235.62, 237.21, 237.16, 238.41, 239.42, 240.54, 241.40, 243.07, 243.14, 244.15, 244.49, 247.08, 246.85, 247.36, 248.78, 250.36, 250.57, 251.02, 252.04, 253.02, 253.86, 254.87, 256.77, 258.34, 256.98, 259.11, 260.01, 260.87, 261.35, 263.74, 263.15, 263.49, 264.67, 266.78, 267.45, 267.58, 269.01, 270.51, 271.30, 271.73, 272.24, 274.09, 274.08, 274.92, 276.72, 277.24, 277.73, 279.58, 279.62, 280.69, 282.00, 283.25, 283.78, 283.56, 285.72, 286.50, 287.92, 288.69, 289.54, 289.54, 291.16, 290.87, 292.86, 293.52, 296.27, 296.14, 294.95, 297.70, 299.34, 298.58, 300.12, 301.26, 302.81, 303.15, 304.00, 304.42, 300.58, 298.75, 304.56, 309.45, 308.78, 309.54, 311.45, 311.55, 313.01, 314.81, 315.47, 316.25, 316.93, 317.80, 318.64, 320.24, 320.49, 321.38, 323.51, 322.41, 324.61, 324.84, 347.13, 348.05, 347.74, 351.05, 350.67, 350.63, 352.64, 354.41, 355.43, 354.28, 356.41, 358.43, 358.29, 357.38, 359.26, 359.30, 358.52, 359.48, 354.27, 355.21, 356.15, 357.09, 358.03];
%distances =[ 365, 250, 248, 260, 382, 395, 391, 388, 391, 390, 377, 379, 373, 362, 356, 353, 347, 345, 341, 339, 332, 329, 326, 320, 318, 315, 313, 313, 309, 307, 305, 302, 302, 299, 296, 297, 294, 292, 290, 290, 289, 287, 286, 286, 283, 283, 282, 283, 280, 280, 280, 280, 279, 279, 280, 279, 279, 279, 279, 280, 280, 280, 280, 280, 281, 281, 282, 282, 283, 284, 285, 286, 287, 288, 290, 293, 292, 292, 296, 299, 298, 301, 304, 304, 303, 310, 314, 311, 314, 318, 323, 321, 327, 334, 335, 337, 349, 350, 349, 350, 361, 340, 357, 380, 391, 385, 385, 108, 396, 398, 396, 392, 390, 389, 386, 385, 383, 383, 381, 343, 343, 379, 379, 342, 381, 380, 362];

%angles = [330.29, 1.00,  1.92,  3.49,  4.03,  4.95,  5.73,  7.61,  7.96,  9.39,  9.77,  10.85, 11.61, 12.28, 13.93, 14.52, 15.37, 16.11, 17.34, 17.43, 19.21, 20.19, 20.69, 21.73, 22.81, 23.44, 24.91, 24.85, 26.23, 27.11, 27.65, 28.48, 29.83, 31.88, 31.59, 33.18, 33.61, 34.51, 35.41, 35.69, 37.38, 37.98, 39.26, 40.78, 41.19, 41.75, 43.42, 43.41, 44.03, 45.45, 46.49, 47.40, 48.19, 49.36, 50.40, 50.39, 52.86, 52.75, 54.19, 60.20, 71.92, 73.37, 73.36, 75.81, 75.42, 76.89, 78.01, 78.31, 79.53, 80.44, 81.25, 82.53, 83.11, 84.22, 84.63, 85.60, 86.55, 88.21, 88.79, 89.83, 90.77, 156.22, 156.90, 158.13, 158.80, 271.96, 278.37, 319.37, 320.45, 321.05, 321.41, 323.52, 324.16, 324.88, 325.72, 327.16, 327.30, 327.42, 329.59, 330.83, 331.49, 331.92, 333.21, 334.42, 334.44, 335.00, 337.09, 337.26, 337.96, 340.22, 341.94, 341.99, 341.93, 343.43, 344.74, 344.69, 346.33, 346.86, 348.69, 347.89, 349.58, 350.48, 351.24, 351.35, 353.81, 354.51, 355.22, 355.66, 356.38, 358.46, 358.56, 359.71, 359.52];
%distances =[276, 270, 270, 269, 269, 270, 269, 270, 269, 270, 270, 270, 270, 271, 271, 273, 273, 273, 275, 275, 277, 278, 280, 280, 282, 284, 284, 286, 287, 290, 292, 294, 295, 297, 299, 300, 305, 306, 310, 312, 317, 319, 322, 328, 328, 335, 337, 341, 348, 348, 353, 362, 366, 373, 377, 384, 389, 397, 396, 398, 398, 396, 96, 383, 385, 383, 380, 379, 376, 376, 372, 373, 372, 370, 368, 368, 336, 327, 352, 352, 248, 300, 297, 357, 395, 399, 397, 389, 380, 369, 372, 368, 356, 354, 349, 343, 335, 331, 334, 326, 323, 318, 318, 312, 310, 308, 305, 302, 300, 298, 296, 293, 291, 290, 289, 284, 283, 283, 280, 279, 280, 277, 275, 275, 275, 274, 273, 272, 272, 271, 271, 271, 271];

% angles = [1.72,  2.38,  3.79,  3.49,  5.36,  5.66,  7.07,  7.76,  8.75,  9.79,  11.26, 11.72, 12.05, 13.41, 14.79, 15.23, 16.42, 17.20, 18.18, 18.64, 20.12, 20.68, 21.44, 22.48, 24.09, 24.88, 25.42, 26.44, 27.73, 27.65, 29.31, 30.25, 31.19, 32.13, 32.52, 33.59, 34.94, 34.80, 36.02, 37.80, 38.33, 39.12, 40.68, 40.90, 42.19, 42.84, 44.14, 44.39, 45.76, 46.91, 47.30, 48.70, 49.87, 50.71, 51.33, 52.31, 53.05, 53.62, 55.17, 56.52, 56.72, 58.88, 59.06, 61.25, 61.64, 62.26, 63.00, 64.19, 64.82, 67.01, 67.37, 68.87, 69.32, 70.51, 71.55, 72.27, 72.48, 74.34, 75.08, 76.00, 76.98, 77.46, 78.95, 79.35, 80.21, 81.38, 82.35, 83.48, 84.16, 85.17, 86.15, 86.57, 88.24, 89.32, 90.26, 90.57, 91.39, 92.43, 93.04, 94.26, 95.56, 97.31, 96.28, 97.63, 98.94, 99.56, 100.09, 101.41, 102.81, 103.76, 104.47, 104.90, 102.36, 105.27, 107.17, 109.98, 109.74, 110.33, 111.33, 112.53, 114.10, 114.30, 115.84, 116.69, 117.30, 118.69, 119.14, 120.07, 121.13, 121.54, 123.16, 123.77, 124.62, 158.72, 162.52, 285.46, 285.89, 287.50, 289.10, 290.17, 289.79, 292.25, 293.04, 291.69, 292.94, 294.91, 296.08, 295.87, 297.53, 298.74, 300.05, 299.68, 301.58, 302.77, 301.69, 302.95, 306.06, 306.57, 305.20, 310.81, 313.42, 313.59, 314.80, 316.25, 316.70, 318.36, 318.65, 319.93, 320.57, 321.21, 321.81, 323.18, 324.56, 324.66, 325.65, 327.40, 327.17, 329.30, 330.08, 331.40, 331.95, 331.73, 333.77, 335.28, 334.78, 335.68, 337.35, 337.98, 337.48, 339.65, 341.66, 342.03, 341.74, 342.83, 344.77, 345.73, 345.50, 347.41, 349.39, 348.74, 350.00, 351.40, 351.14, 351.74, 354.11, 354.66, 355.88, 355.92, 356.84, 358.93, 358.51, 359.54];
% distances = [399, 291, 291, 290, 290, 290, 290, 290, 290, 290, 290, 290, 290, 291, 291, 292, 292, 293, 293, 294, 296, 296, 298, 299, 300, 301, 303, 305, 307, 308, 310, 310, 313, 315, 319, 320, 324, 324, 327, 330, 332, 338, 342, 345, 348, 353, 358, 358, 365, 371, 375, 377, 384, 388, 393, 400, 406, 413, 420, 427, 433, 440, 449, 429, 450, 444, 439, 436, 101, 102, 418, 414, 413, 407, 405, 399, 398, 395, 392, 388, 386, 385, 383, 370, 364, 376, 374, 373, 373, 355, 345, 343, 342, 348, 447, 447, 445, 445, 445, 444, 444, 443, 443, 443, 443, 444, 444, 445, 445, 446, 447, 448, 448, 449, 452, 454, 454, 454, 457, 459, 462, 464, 464, 469, 472, 473, 475, 480, 485, 482, 489, 495, 499, 270, 106, 414, 415, 418, 443, 444, 443, 445, 448, 449, 449, 455, 455, 457, 458, 465, 465, 464, 472, 475, 476, 477, 482, 488, 493, 497, 482, 491, 489, 479, 460, 462, 456, 437, 429, 421, 424, 413, 402, 393, 397, 380, 376, 372, 367, 360, 357, 360, 348, 345, 342, 342, 341, 330, 331, 329, 321, 320, 319, 317, 312, 312, 313, 310, 306, 305, 305, 302, 301, 300, 299, 295, 296, 295, 295,  291, 290, 290];

angles = [1.07,  1.61,  3.13,  3.37,  5.06,  6.21,  7.27,  8.49,  8.53,  9.78,  10.53, 11.38, 12.58, 13.41, 14.66, 14.81, 16.49, 17.54, 18.62, 19.41, 20.55, 21.05, 21.50, 22.60, 23.15, 24.93, 25.65, 26.25, 27.22, 28.24, 29.39, 29.84, 30.89, 31.59, 32.26, 33.30, 34.93, 35.94, 36.74, 37.38, 38.47, 39.37, 39.71, 40.77, 42.04, 43.08, 44.03, 44.78, 45.62, 46.07, 47.65, 48.60, 49.22, 50.45, 51.85, 52.60, 54.61, 55.10, 55.80, 57.13, 57.30, 58.32, 59.56, 59.95, 61.43, 61.69, 62.53, 64.48, 65.02, 65.88, 67.35, 67.67, 68.72, 69.63, 71.01, 72.32, 73.10, 74.19, 75.93, 75.52, 76.70, 77.39, 78.82, 79.35, 79.88, 81.37, 82.09, 83.71, 83.94, 85.56, 86.13, 86.51, 87.73, 89.92, 91.07, 91.49, 92.78, 94.00, 94.22, 95.49, 96.34, 96.66, 98.01, 98.74, 100.34, 101.24, 101.77, 102.46, 103.78, 105.08, 104.81, 105.96, 106.88, 108.03, 109.05, 110.74, 110.90, 111.39, 112.18, 113.80, 113.73, 114.77, 115.65, 117.90, 117.78, 118.68, 120.74, 121.17, 121.67, 122.16, 123.63, 124.83, 125.07, 126.66, 127.66, 128.56, 128.89, 130.05, 130.68, 131.59, 133.21, 134.10, 135.30, 134.76, 136.37, 137.93, 137.99, 139.54, 140.12, 144.92, 146.32, 146.03, 147.70, 148.71, 149.02, 149.71, 151.39, 153.11, 152.88, 153.57, 159.70, 161.05, 162.56, 164.06, 165.21, 166.64, 165.71, 168.33, 169.72, 169.38, 169.35, 171.72, 172.97, 172.91, 173.63, 175.83, 176.18, 176.12, 177.86, 179.70, 179.47, 181.06, 182.55, 184.08, 183.91, 185.03, 186.76, 186.63, 187.06, 188.67, 190.60, 190.10, 191.54, 192.88, 193.58, 194.30, 194.01, 198.39, 199.08, 199.63, 201.28, 202.23, 202.63, 203.91, 204.78, 205.50, 206.57, 206.73, 208.93, 209.71, 209.57, 210.26, 211.72, 213.23, 213.81, 215.02, 216.43, 216.77, 216.33, 217.26, 220.24, 220.24, 220.82, 222.48, 223.99, 223.38, 224.28, 225.98, 226.85, 227.07, 227.49, 230.92, 230.52, 230.57, 232.24, 234.05, 233.02, 234.33, 236.20, 237.72, 237.47, 237.83, 239.00, 241.52, 240.46, 243.11, 243.89, 243.74, 244.79, 244.45, 248.15, 248.09, 248.42, 250.26, 250.65, 251.12, 251.10, 253.58, 254.67, 254.18, 257.69, 260.56, 261.78, 260.62, 263.68, 265.23, 265.43, 265.57, 267.77, 268.34, 268.96, 269.04, 271.34, 272.34, 272.52, 272.90, 275.09, 275.72, 275.04, 277.19, 278.71, 278.32, 278.68, 280.82, 282.62, 282.83, 283.33, 284.95, 286.21, 285.42, 287.14, 288.66, 288.46, 288.79, 291.69, 292.83, 292.86, 293.39, 295.37, 295.74, 295.89, 296.86, 299.66, 299.68, 300.12, 299.91, 303.29, 302.67, 302.95, 304.79, 306.82, 306.40, 306.70, 308.57, 310.07, 309.45, 310.08, 313.07, 313.32, 312.62, 315.30, 316.65, 316.72, 317.13, 319.22, 319.60, 319.90, 320.78, 323.13, 323.02, 323.18, 323.93, 327.08, 326.66, 327.24, 328.88, 330.63, 330.40, 329.91, 332.48, 334.17, 333.26, 334.46, 336.64, 338.08, 338.00, 338.06, 339.60, 340.33, 340.85, 342.47, 344.63, 344.57, 343.61, 345.77, 347.30, 348.08, 347.35, 350.57, 351.55, 351.11, 351.33, 353.40, 354.58, 355.31, 356.75, 357.04, 357.61, 358.90, 359.88, 359.56, 359.60];
distances = [260, 261, 262, 262, 264, 265, 267, 267, 268, 270, 271, 273, 273, 276, 277, 278, 282, 283, 285, 286, 291, 291, 294, 297, 301, 305, 306, 311, 315, 318, 320, 326, 330, 334, 336, 344, 348, 355, 359, 369, 374, 376, 385, 392, 400, 409, 415, 421, 401, 481, 425, 423, 415, 409, 407, 404, 402, 398, 392, 392, 387, 384, 382, 378, 377, 373, 371, 369, 373, 360, 362, 361, 359, 358, 358, 357, 356, 340, 332, 330, 329, 330, 435, 434, 426, 418, 417, 448, 437, 435, 435, 437, 437, 438, 438, 440, 442, 443, 445, 446, 448, 448, 452, 454, 455, 457, 461, 463, 464, 469, 475, 475, 476, 479, 488, 489, 492, 498, 506, 509, 514, 519, 527, 525, 533, 544, 553, 548, 558, 563, 573, 578, 601, 605, 602, 617, 632, 636, 644, 670, 681, 690, 707, 710, 754, 784, 812, 852, 860, 894, 889, 935, 980, 980, 284, 322, 366, 363, 1401, 1628, 1615, 1360, 1195, 1195, 1193, 1158, 1121, 1137, 1123, 1137, 123, 124, 124, 1104, 765, 790, 780, 1175, 1140, 1138, 1129, 1140, 1137, 1128, 1121, 1120, 1131, 1155, 1154, 1039, 1034, 1039, 1059, 1035, 1169, 1180, 1206, 1152, 1148, 2149, 2180, 2187, 2214, 2228, 2238, 2262, 2260, 2292, 2320, 2340, 2374, 2413, 2408, 2437, 2463, 2595, 2601, 2625, 2680, 2705, 2733, 2756, 2630, 2672, 2697, 2677, 2632, 2661, 2625, 2618, 2572, 2565, 2537, 2491, 1166, 1156, 1154, 1185, 1203, 1183, 849, 797, 793, 796, 789, 811, 943, 949, 967, 399, 399, 320, 326, 1850, 336, 1647, 3496, 3326, 3529, 4504, 2932, 2927, 2936, 2933, 422, 421, 422, 447, 448, 448, 448, 451, 451, 451, 455, 456, 456, 458, 461, 464, 463, 466, 474, 475, 474, 478, 482485, 489, 492, 498, 500, 501, 506, 493, 488, 494, 466, 457, 443, 438, 419, 412, 417, 394, 379, 380, 382, 368, 352, 362, 354, 342, 340, 334, 334, 325, 320, 319, 315, 310, 310, 305, 298, 297, 297, 296, 288, 286, 286, 283, 280, 280, 280, 276, 273, 272, 271268, 267, 268, 1038, 1179, 1172, 1195, 1150, 2149, 2171, 2177, 2202, 2209, 2208, 2249, 2265, 2290, 2292, 2313, 2346, 2374, 2370, 2413, 2461, 2452, 2550, 2605, 2625, 2625, 2694, 2771, 2766, 2654, 2690, 2721, 2682];
% 将极坐标转换为直角坐标
x = distances .* cosd(angles);
y = distances .* sind(angles);
% 合并数据
data = [x; y];

% 绘制数据点
figure;
plot(data(1,:), data(2,:), 'o');
hold on;

iter = 1000;
number = size(data, 2); % 总点数
bestParameter1 = 0;
bestParameter2 = 0;
sigma = 4;
q_num = 38; %符合直线的标准点数
pretotal = 0; % 符合拟合模型的数据的个数

j=1;
for i = 1:iter
    % 随机选择两个点
    idx = randperm(number, 2);
    sample = data(:, idx);

    % 拟合直线方程 y = kx + b
    line = zeros(1, 3);
    x = sample(1, :);
    y = sample(2, :);

    k = (y(1) - y(2)) / (x(1) - x(2)); % 直线斜率
    b = y(1) - k * x(1);
    line = [k -1 b];

    mask = abs(line * [data; ones(1, size(data, 2))]); % 求每个数据到拟合直线的距离
    total = sum(mask < sigma); % 计算数据距离直线小于一定阈值的数据的个数

    if total > pretotal % 找到符合拟合直线数据最多的拟合直线
        pretotal = total;
        bestline = line; % 找到最好的拟合直线
    end
    %%%%%%%%%%%%%%%%%%%%%%%%%
    if total > q_num
        qualified_line(j) = {line};
        j = j + 1;
    end
end

% 显示符合最佳拟合的数据
mask = abs(bestline * [data; ones(1, size(data, 2))]) < sigma;
hold on;
k = 1;
for i = 1:length(mask)
    if mask(i)
        inliers(:, k) = data(:, i);
        k = k + 1;
        plot(data(1, i), data(2, i), '+');
    end
end

% 绘制最佳匹配直线
bestParameter1 = -bestline(1) / bestline(2);
bestParameter2 = -bestline(3) / bestline(2);
xAxis = min(inliers(1, :)):max(inliers(1, :));
yAxis = bestParameter1 * xAxis + bestParameter2;
plot(0,0,'^','MarkerSize',15,'MarkerFaceColor','auto');
plot(xAxis, yAxis, 'r-', 'LineWidth', 3);

title(['Best Line: y = ', num2str(bestParameter1), 'x + ', num2str(bestParameter2)]);


for i = 1:size(qualified_line,2)
    qline = qualified_line{i};
    Parameter1 = -qline(1) / qline(2);
    Parameter2 = -qline(3) / qline(2);
    mask = abs(qline * [data; ones(1, size(data, 2))]) < sigma;
    k = 1;
    for j = 1:length(mask)
        if mask(j)
            inliers(:, k) = data(:, j);
            k = k + 1;
            plot(data(1, j), data(2, j), '+');
        end
    end
    xAxis = min(inliers(1, :)):max(inliers(1, :));
    yAxis = Parameter1 * xAxis + Parameter2;
    plot(xAxis, yAxis, 'g-', 'LineWidth', 1);
end

% filename = 'data.txt';  % 文件名
% fileID = fopen(filename, 'w');  % 打开文件
% 
% % 将数据写入文件
% for i = 1:size(data, 1)
%     fprintf(fileID, '%f\t,', data(i, 1:end-1));  % 写入每行的数据（最后一列之前）
%     fprintf(fileID, '%f\n', data(i, end));  % 写入每行的最后一列数据，并换行
% end
% 
% fclose(fileID);  % 关闭文件
% disp('数据已保存为文本文件。');
